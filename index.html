<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Weather Central 1997 - BOM Powered</title>
  <style>
    html,body{height:100%;margin:0}
    body{
      background: linear-gradient(180deg,#ffeeff 0%, #fff0e6 100%);
      font-family: "Verdana", "Trebuchet MS", Arial, sans-serif;
      color:#000;
      display:flex;align-items:flex-start;justify-content:center;padding:20px;
    }
    .window{
      width:920px;
      border:6px groove #ffffff;
      background: linear-gradient(180deg,#f8f8ff 0%, #e6f0ff 100%);
      box-shadow:8px 8px 0 rgba(0,0,0,0.15);
      padding:12px;
    }
    header{display:flex;align-items:center;gap:12px;margin-bottom:8px;}
    .logo{width:84px;height:84px;background:#ffe6f2;border:3px solid #ff99cc;display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:14px;box-shadow:inset 0 0 0 2px rgba(255,255,255,0.6)}
    h1{font-size:28px;margin:0;color:#3a0b47;font-family: 'Trebuchet MS', Verdana}
    .controls{display:flex;gap:8px;align-items:center;margin:8px 0}
    input[type=text]{padding:8px;border:2px inset #fff;border-radius:4px;width:320px}
    button{padding:8px 12px;border:2px outset #ddd;background:#fff;cursor:pointer}
    button:active{border-style:inset}
    .marquee{background:#000;color:#0f0;padding:6px;font-family:monospace;margin:10px 0}
    .card{display:flex;gap:16px;padding:12px;border:2px solid #00000012;background:linear-gradient(180deg,#fff 0%,#f2f9ff 100%);align-items:center}
    .big-temp{font-size:64px;font-weight:bold;line-height:1}
    .meta{font-size:14px}
    .forecast{margin-top:12px;display:flex;gap:8px;overflow:auto}
    .day{min-width:120px;padding:8px;border:2px dashed #ccc;background:#fff}
    footer{margin-top:12px;font-size:12px;color:#333}
    .trail{position:fixed;pointer-events:none;z-index:9999}
    .pixel{width:8px;height:8px;background:rgba(255,0,128,0.8);border-radius:2px;position:absolute}
    a{color:#0033cc;text-decoration:underline}
    @media (max-width:960px){.window{width:100%}}
  </style>
</head>
<body>
  <div class="window">
    <header>
      <div class="logo">WEATHER<br>1997</div>
      <div>
        <h1>Weather Central '97</h1>
        <div style="font-size:12px;color:#555">Retro vibes, live data (BOM where possible)</div>
      </div>
    </header>
    <div class="marquee"><marquee behavior="scroll" scrollamount="4">WELCOME TO WEATHER CENTRAL 1997 ‚Äî LIVE TEMPERATURES VIA BOM & OPEN-METEO ACCESS-G</marquee></div>
    <div class="controls">
      <input id="q" type="text" placeholder="Enter suburb, postcode or place (e.g. Melbourne, 3000)" value="Melbourne">
      <button id="search">Get Weather</button>
      <label style="margin-left:auto;font-size:12px">Mode: <select id="mode"><option>Auto</option><option>BOM</option><option>Open-Meteo</option></select></label>
    </div>
    <div id="status" style="font-size:13px;color:#333;margin-bottom:8px">Idle ‚Äî enter a place and press Get Weather</div>
    <div class="card">
      <div><div id="icon" style="font-size:48px">‚òÄÔ∏è</div></div>
      <div>
        <div class="big-temp" id="temp">--¬∞C</div>
        <div class="meta" id="place">‚Äî</div>
        <div class="meta" id="desc">‚Äî</div>
      </div>
    </div>
    <div id="forecast" class="forecast"></div>
    <footer>
      <div>Note: Displays *current temperature* directly from BOM or Open-Meteo ACCESS-G model. Live, real-time data when possible.</div>
      <div>Credits: Bureau of Meteorology data where available. Made with HTML, CSS & JavaScript ‚Äî retro edition.</div>
    </footer>
  </div>
  <div id="trail" class="trail"></div>
  <script>
    const trail=document.getElementById('trail');
    document.addEventListener('mousemove',e=>{const p=document.createElement('div');p.className='pixel';p.style.left=(e.clientX-4)+'px';p.style.top=(e.clientY-4)+'px';trail.appendChild(p);setTimeout(()=>p.remove(),600);});
    const statusEl=document.getElementById('status'),placeEl=document.getElementById('place'),descEl=document.getElementById('desc'),tempEl=document.getElementById('temp'),forecastEl=document.getElementById('forecast'),iconEl=document.getElementById('icon');
    async function bomSearch(q){const r=await fetch(`https://api.weather.bom.gov.au/v1/locations?search=${encodeURIComponent(q)}`);if(!r.ok)throw new Error('BOM search failed');const j=await r.json();if(!j.locations||!j.locations.length)throw new Error('No BOM locations');return j.locations[0];}
    async function bomCurrent(loc){const r=await fetch(`https://api.weather.bom.gov.au/v1/locations/${loc.id}/observations`);if(!r.ok)throw new Error('BOM current failed');return r.json();}
    async function openMeteoForecast(lat,lon){const r=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&daily=temperature_2m_max,temperature_2m_min,weathercode&timezone=auto`);if(!r.ok)throw new Error('Open-Meteo failed');return r.json();}
    function renderCurrentBOM(data,label){const obs=data.observations?.data?.[0];if(obs){tempEl.textContent=Math.round(obs.air_temp)+'¬∞C';descEl.textContent=obs.wx_desc||'Current weather';iconEl.textContent='‚õÖ';placeEl.textContent=label;}else{throw new Error('No BOM obs');}}
    function renderOpenMeteo(data,label){if(data.current_weather){tempEl.textContent=Math.round(data.current_weather.temperature)+'¬∞C';descEl.textContent='Current weather';iconEl.textContent='üå§Ô∏è';placeEl.textContent=label;}forecastEl.innerHTML='';if(data.daily){for(let i=0;i<Math.min(7,data.daily.time.length);i++){const d=document.createElement('div');d.className='day';d.innerHTML=`<strong>${data.daily.time[i]}</strong><div>Min: ${Math.round(data.daily.temperature_2m_min[i])}¬∞C</div><div>Max: ${Math.round(data.daily.temperature_2m_max[i])}¬∞C</div>`;forecastEl.appendChild(d);}}}
    async function doSearch(){const q=document.getElementById('q').value.trim(),mode=document.getElementById('mode').value;statusEl.textContent='Fetching weather...';try{if(mode==='BOM'||mode==='Auto'){try{const loc=await bomSearch(q);const data=await bomCurrent(loc);renderCurrentBOM(data,loc.name||loc.longName);statusEl.textContent='BOM current temperature shown';return;}catch(e){if(mode==='BOM')throw e;statusEl.textContent='BOM failed, fallback...';}}const geo=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(q)}&limit=1`);const gj=await geo.json();if(!gj[0])throw new Error('Could not geocode');const data=await openMeteoForecast(gj[0].lat,gj[0].lon);renderOpenMeteo(data,gj[0].display_name);statusEl.textContent='Open-Meteo current temperature shown';}catch(err){statusEl.textContent='Error: '+err.message;tempEl.textContent='--¬∞C';descEl.textContent='--';placeEl.textContent='--';forecastEl.innerHTML='';}}
    document.getElementById('search').addEventListener('click',doSearch);document.getElementById('q').addEventListener('keydown',e=>{if(e.key==='Enter')doSearch();});setTimeout(doSearch,300);
  </script>
</body>
</html>
